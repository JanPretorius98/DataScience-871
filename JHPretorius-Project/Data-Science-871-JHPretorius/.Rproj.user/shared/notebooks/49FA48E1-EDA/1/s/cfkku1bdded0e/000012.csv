"0","# Creating a new data frame df_country with mean profile views per country"
"0","df_country <- df_city %>%"
"0","  group_by(address) %>%"
"0","  summarize(mean_profile_views = mean(mean_profile_views))"
"0",""
"0","# Creating ggplot with map"
"0","map_bg <- ggplot(data = world) +"
"0","  geom_polygon(aes(x = long, y = lat, group = group), fill = ""white"", colour = ""black"") +"
"0","  coord_map() +"
"0","  theme_void()"
"0",""
"0","# Creating choropleth map"
"0","choropleth <- map_bg +"
"0","  geom_polygon(data = df_country, aes(x = lon, y = lat, group = group, fill = mean_profile_views), alpha = 0.8) +"
"0","  scale_fill_gradient("
"0","    name = ""Mean Profile Views"","
"0","    limits = range(df_country$mean_profile_views),"
"0","    low = ""#8c2aef"","
"0","    high = ""#1beaa7"""
"0","  ) +"
"0","  theme("
"0","    plot.background = element_rect(fill = ""#000123"", color = ""#000123""),"
"0","    panel.background = element_rect(fill = ""#000123"", color = ""#000123""),"
"0","    panel.grid.major = element_blank(),"
"0","    panel.grid.minor = element_blank(),"
"0","    axis.text = element_blank(),"
"0","    legend.key = element_rect(fill = ""#000123"", color = ""#000123""),"
"0","    legend.background = element_rect(fill = ""#000123""),"
"0","    legend.text = element_text(colour = ""white""),"
"0","    legend.title = element_text(colour = ""white""),"
"0","    plot.margin = margin(0, 0, 0, 0)"
"0","  )"
"0",""
"0","print(choropleth)"
"1","[1m[33mError[39m in `geom_polygon()`:[22m
[38;5;255m[33m![38;5;255m Problem while computing aesthetics.
[36mâ„¹[38;5;255m Error occurred in the 2nd layer.[39m
[1mCaused by error:[22m
[33m![39m object 'group' not found
Backtrace:
[90m  1. [39m[1mbase[22m::print(choropleth)
[90m  3. [39mggplot2:::print.ggplot(choropleth)
[90m  5. [39mggplot2:::ggplot_build.ggplot(x)
[90m  6. [39mggplot2:::by_layer(...)
[90m 13. [39mggplot2 (local) f(l = layers[[i]], d = data[[i]])
[90m 14. [39ml$compute_aesthetics(d, plot)
[90m 15. [39mggplot2 (local) compute_aesthetics(..., self = self)
[90m 16. [39mggplot2:::scales_add_defaults(...)
[90m 17. [39m[1mbase[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)
[90m 18. [39m[1mrlang[22m (local) FUN(X[[i]], ...)
"
