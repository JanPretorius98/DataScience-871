"0",""
"0","# Define dummy variable that detects presence of emojis"
"0","df <- df %>%"
"0","  mutate(has_emoji = ifelse(emoji_detect(whazzup), 1, 0))"
"0",""
"0","# Get the most used words in profile"
"0","# First, create a table of words with the corresponding counts_profileVisits"
"0","words_visits <- df %>%"
"0","  unnest_tokens(word, whazzup) %>%"
"0","  mutate(word = str_remove_all(word, ""[[:digit:]]+"")) %>%"
"0","  select(word, counts_profileVisits)"
"0",""
"0","# Then calculate the mean counts_profileVisits for each word and its count"
"0","words <- words_visits %>%"
"0","  group_by(word) %>%"
"0","  summarise(mean_profileVisits = mean(counts_profileVisits, na.rm = TRUE),"
"0","            word_count = n(), "
"0","            .groups = ""drop"")"
"0",""
"0","# Create word popularity index and determine popular words"
"0","words <- words %>%"
"0","  mutate(popularity_index = 0.8 * word_count + 0.2 * mean_profileVisits) %>% "
"0","  filter(popularity_index > 200 & word_count > 10, "
"0","         word != """", "
"0","         !is.na(word), "
"0","         !is.na(mean_profileVisits), "
"0","         !is.na(word_count), "
"0","         !is.na(popularity_index)) %>%"
"0","  filter(!word %in% stopwords::stopwords(""de"")) %>%"
"0","  filter(!word %in% stopwords::stopwords(""en""))"
"0",""
"0","# Create a single pattern string that matches any word in words$word"
"0","words_pattern <- paste(words$word, collapse = ""|"")"
"0",""
"0","# Add the new variable to df"
"0","df <- df %>%"
"0","  mutate(contains_popular_word = ifelse(str_detect(whazzup, words_pattern), 1, 0)) %>%"
"0","  mutate("
"0","    contains_popular_word = replace_na(contains_popular_word, 0),"
"0","    has_emoji = replace_na(has_emoji, 0)"
"0","  )"
"0",""
"0","words <- words %>%"
"0","  arrange(desc(popularity_index)) %>% "
"0","  select(c(word, popularity_index))"
"0",""
"0","head(words)"
