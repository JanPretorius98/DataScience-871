"0","df_city <- read_excel(""geocode_latlon.xlsx"")"
"0",""
"0","df_city <- df_city %>%"
"0","  mutate(mean_profile_views = as.numeric(mean_profile_views),"
"0","         lat = as.numeric(lat),"
"0","         lon = as.numeric(lon)) %>% "
"0","  filter(!is.na(lon),"
"0","         mean_profile_views > 0,"
"0","         lon > -90 & lon < 100,"
"0","         lat > 0)"
"0",""
"0","# Filter by countries after data cleaning and transformation"
"0","df_city <- df_city %>%"
"0","  filter(substr(address, nchar(address) - 1, nchar(address)) %in% eu_countries$code | address == ""UK"")"
"0",""
"0","world <- map_data(""world"") %>%"
"0","  filter(region %in% eu_countries$name | region == ""UK"" | region == ""Czech Republic"" | region == ""Switzerland"")"
"0",""
"0","# Creating ggplot with map"
"0",""
"0","map_bg <- ggplot(data = world) +"
"0","  geom_polygon(aes(x = long, y = lat, group = group), fill = ""white"", colour = ""#000123"") +"
"0","  coord_map() +"
"0","  theme_void()"
"0",""
"0","# Adding scatterplot on the map"
"0","views <- map_bg +"
"0","  geom_point(data = df_city, aes(x = lon, y = lat, color = mean_profile_views, size = mean_profile_views), alpha = 0.8) +"
"0","  scale_colour_gradient("
"0","    name = 'Profile Views',"
"0","    limits = range(df_city$mean_profile_views),"
"0","    low = ""#8c2aef"","
"0","    high = ""#1beaa7"""
"0","  ) +"
"0","  scale_size_continuous(guide = ""none"", range = c(1, 8)) +"
"0","  theme(plot.background = element_rect(fill = ""#000123"", color = ""#000123""),"
"0","        panel.background = element_blank(),"
"0","        panel.grid.major = element_blank(),"
"0","        panel.grid.minor = element_blank(),"
"0","        axis.text = element_blank(),"
"0","        legend.key = element_rect(fill = ""#000123"", color = ""#000123""),"
"0","        legend.background = element_rect(fill = ""#000123""),"
"0","        legend.text = element_text(colour = ""white""),"
"0","        legend.title = element_text(colour = ""white""))"
"0",""
"0","print(views)"
