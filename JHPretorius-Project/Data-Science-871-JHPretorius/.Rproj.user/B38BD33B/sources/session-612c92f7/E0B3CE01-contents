# My first ML model
  # Data - Ames Data Set

ames <- AmesHousing::make_ames()  # Ames housing data

# Using rsample package
split <- initial_split(ames, prop = 0.7)  # Split the dataset 
ames_train <- training(split)  # Training set
ames_test <- testing(split)  # Test set

# Specify resampling strategy
cv <- trainControl(
  method = "repeatedcv", 
  number = 10, 
  repeats = 5
)

# Create grid of hyperparameter values
hyper_grid <- expand.grid(k = seq(2, 25, by = 1))

# Tune a knn model using grid search
knn_fit <- train(
  Sale_Price ~ ., 
  data = ames_train, 
  method = "knn", 
  trControl = cv, 
  tuneGrid = hyper_grid,
  metric = "RMSE"
)  

knn_fit
